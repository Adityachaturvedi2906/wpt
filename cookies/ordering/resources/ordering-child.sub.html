<!doctype html>
<html>
  <head>
    <meta charset=utf-8>
    <title>Test cookie ordering</title>
    <meta name=help href="https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-07#section-5.5">
    <meta name="timeout" content="long">
    <script src="/resources/testharness.js"></script>
    <script src="/cookies/resources/cookie-test.js"></script>
  </head>
  <body>
    <div id=log></div>
    <script>
      const host = "{{host}}";
      const wwwHost = "{{domains[www]}}";

      const orderingTests = [
        {
          cookie: [
            "testA=1",                  // default path, won't be returned
            "testB=1; path=/cookies/attributes/resources",
            "testC=1; path=/",
            "testD=1; path=/cooking",   // wrong path, won't be returned
            `testE=1; domain=.${host}`, // default path, won't be returned
            `testF=1; domain=.${host}; path=/cookies/attributes`,
            `testG=1; domain=.${host}; path=/cookies/attributes/resources/path`,
            "testH=1; path=/cookies",
          ],
          expected: "testG=1; testB=1; testF=1; testH=1; testC=1",
          name: "Cookies with longer domain + path attribute values (combined) are ordered before shorter ones",
          location: "/cookies/attributes/resources/path/one.html",
        },
        {
          cookie: [
            "testA=2; path=/cookies/attributes/resources/path",
            "testB=2; path=/cookies/attributes/resources/path/one.html",
            "testC=2; path=/cookies/attributes",
          ],
          expected: "testB=2; testA=2; testC=2",
          name: "Cookies with longer paths are listed before cookies with shorter paths",
          location: "/cookies/attributes/resources/path/one.html",
        },
        {
          cookie: [
            "testZ=4; path=/cookies",
            "testB=4; path=/cookies/attributes/resources/path",
            "testA=4; path=/cookies",
          ],
          expected: "testB=4; testZ=4; testA=4",
          name: "For equal length paths, list the cookie with an earlier creation time first",
          location: "/cookies/attributes/resources/path/one.html",
        },
      ];

      for (const test of orderingTests) {
        httpRedirectCookieTest(test.cookie, test.expected, test.name,
                               test.location);
      }
    </script>
  </body>
</html>